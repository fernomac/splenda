<html>
  <head>
    <title>Splenda</title>
    <link href="/assets/main.css" rel="stylesheet" type="text/css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
      const userid = '{{USERID}}'
      const gameid = '{{GAMEID}}'

      const othercolor = {
        'red': 'white',
        'blue': 'white',
        'green': 'white',
        'black': 'white',
        'white': 'black',
      }

      var game = {}

      function renderNobles(nobles) {
        var html = '<div class="nobles">'

        for (noble of nobles) {
          html += '<div class="noble">'
          html += '<div class="info">'
          html += '<div class="points">' + noble.points + '</div>'
          html += '<div style="flex-grow: 1;"></div>'
          for (color in noble.cost) {
            html += '<div class="cost ' + color + '">'
            html += noble.cost[color]
            html += '</div>'
          }
          html += '</div></div>'
        }

        html += '</div>'
        return html
      }

      function renderCards(cards) {
        var html = '<div class="cards">'
        for (card of cards) {
          html += '<div class="card ' + card.color + 'card">'
          html += '<div class="top">'
          html += '<div class="points">' + card.points + '</div>'
          html += '<div class="gem ' + card.color + '"></div>'
          html += '</div><div class="info">'
          for (color in card.cost) {
            html += '<div class="cost ' + color + '">'
            html += card.cost[color]
            html += '</div>'
          }
          html += '</div></div>'
        }
        html += '</div>'
        return html
      }

      function renderCoins(coins) {
        var html = '<div class="coins">'
        for (color of ['green', 'white', 'blue', 'black', 'red', 'wild']) {
          html += '<div class="coin ' + color + '"><div class="num">' + coins[color] + '</div></div>'
        }
        html += '</div>'
        return html
      }

      function renderTable(table) {
        var html = renderNobles(table.nobles)
        html += '<div>'
        html += renderCards(table.cards[2])
        html += renderCards(table.cards[1])
        html += renderCards(table.cards[0])
        html += '</div>'
        html += renderCoins(table.coins)

        document.getElementById('table').innerHTML = html
      }

      function render() {
        // document.getElementById('hand').innerHTML = JSON.stringify(game)
        renderTable(game.table)
      }

      function update() {
        fetch('/api/games/'+gameid).then(function(res) {
          return res.json()
        }).then(function(json) {
          game = json
          render()
        })
      }

      window.onload = update
    </script>
  </head>
  <body>
    <div class="root">
      <div class="top-bar">
        <span class="logo">Splenda</span>
        <span class="links"><a href="logout">logout</a></span>
      </div>
      <div class="main">

<div style="width: 100%; flex-grow: 1; display: flex; flex-direction: row;">
  <div id="table" class="table"></div>
  <div id="players" style="height: 100%; width: 20%; border-left: 1px solid #AAA;"></div>
</div>
<div id="hand" style="width: 100%; height: 20%; border-top: 1px solid #AAA"></div>

      </div>
    </div>
  </body>
</html>
